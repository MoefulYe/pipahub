---
created_at: 2024-07-24
modified_at: 2024-07-24
description: 
aliases: 
tags:
  - 计算机网络
title: 介质访问控制
---
本质上是将广播信道改造成逻辑上的点对点信道, 对比[[../../计算机组成原理/总线|总线]]的控制机制
## 信道划分介质控制
### FDM频分复用
各个用户分配不同的**频带**，之后始终使用相同的频带进行通信。
### TDM时分复用
比起模拟信号更适合数字信号传输
#### 改进：统计时分复用（STDM）
使用集中器收集各个用户的数据，并按照先后顺序存入自己的缓存，之后按照先后顺序填充STDM帧，帧满即发送出去。
STDM帧大小小于连接在集中器上的用户数
### WDM波分复用
### CDM码分复用
每一个信源发出的码元是一个逻辑上的向量，与其他信源发出的向量相交，因此在一个信道上不同信源发出的码元是互不干扰的，接收方只要用内积运算便能提取出所需的分量
**0代表-1，1代表1这个与符号位不同**
**内积被定义为：**
$$
\vec a \cdot \vec b = \frac{1}{m} \sum_{i=1}^{m}a_i \cdot b_i
$$
## 随机访问介质控制
上面的信道划分控制更集中控制一点，而随机访问介质控制是一个**分布式**的控制方式
所有的用户可以随机的发送信息，发送信息时占用**全部带宽**，因此随机访问介质控制是种**半双工的通信**方式
### ALOHA协议
- 想发就发，发完等ack，收到nak就重发
- 不按时隙发送
- 当网络上的两个传输点同时向频道传输数据的时候，会发生冲突，这种情况下，两个点各自等待一段**随机长度**的时间后，再次尝试传送。
#### 时隙ALOHA
必须在每一个时隙的开始才能发送，每次传送的数据必须少于或者等于一个频道的一个时间分段。这样大大的减少了传输频道的冲突。
### CSMA

| 信道状态 | 1-坚持        | 非坚持              | p-坚持                       |
| ---- | ----------- | ---------------- | -------------------------- |
| 空闲   | 立刻发送数据      | 立刻发送数据           | 以p的概率发送数据，否则等到下一个**时隙**再看看 |
| 忙碌   | 继续监听到空闲发送数据 | 等待一段随机时间再来查看信道状态 | 等到下一个**时隙**再看看             |
### CSMA/CD
![Pasted image 20240724194424](https://r2.pipago360.site/pupahub/2024/09/392994423fdcb22570347963a7a30601.png)
由于信源之间有时空距离，在发送前监听还不太够，例如我准备开始发送数据了，另外也有一个信源也开始发送数据，因为我们之间有时空距离，我还不知道他也要发送数据，因此在我发送数据时会产生冲突。因此在**争用期** $2\tau$ 内要检测冲突，一旦有冲突要停止发送做相应处理。
#### 争用期
以太网规定争用期的长度是**51.2**$\mu s$，因此对于10Mbps的以太网的**最短帧长**是64B，小于64B的都是**无效帧**，最短帧长=总线**往返**传输时延 * 带宽
#### 二进制指数退避
- 发生冲突后要退避
- 确定基本退避时间，一般为$2 \tau$
- 从$[0, 2^k),\space 其中k为重传次数如果重传次数超过10次还是按10来计$ 中选择一个随机整数$r$,把$2\tau \cdot r$作为回退时间
- 当重传**16次**仍然不成功时说明网络拥挤，向上层报告出错
### CSMA/CA
#### 采用停等协议
#### IFS（Inter Frame Space）
- SIFS 短帧间间隔 ACK的应答帧，CDS帧，分片的数据帧以及所有回答AP探寻的帧和在点协调功能方式中接入点AP发出的数据帧
- PIFS 点协调IFS 在点协调操作中使用
- DIFS 分布式协调IFS 最长的IFS 用于异步竞争的访问时延
#### 虚拟载波监听机制
802.11 标准还采用了虚拟载波监听机制，即让源站将它要占用信道的持续时间（包括目的站，抛 发回ACK帧所需的时间）及时通知给所有其他站，以便使所有其他站在这段时间内都停止发送，这样就大大减少了冲突的机会。“虚拟载波监听”表示其他站并未监听信道，而是因收到了源站的通知才不发送数据，这种效果就像是其他站都监听了信道。
#### 隐蔽站与预约信道

![11AEE1098ECCCE04F7A55792A966E503](https://r2.pipago360.site/pupahub/2024/09/11aee1098eccce04f7a55792a966e503.png)
在图3.22中，站A和站B都在AP的覆盖范围内，但站A和站B相距较远，彼此都听不见对方。当站A和站B检测到信道空闲时，都向AP发送数据，导致冲突发生，这就是隐蔽站问题。
为了避免该问题，802.11 标准**允许不是强制**发送站对信道进行预约，如图3.23所示。源站要发送数据帧之前，先监听信道，若信道空闲，则等待时间 DIFS 后，广播一个请求发送RTS （Request To Send）控制帧，它包括源地址、目的地址和这次通信所需的持续时间。若**AP**正确收到RTS帧，且信道空闲，则等待时间SIFS后，向源站发送一个允许发送 CTS（Clear To Send）控制帧，它也包括这次通信所需的持续时间，源站收到CTS帧后，再等待时间SIFS，就可发送数据帧。若 AP正确收到了源站发来的数据，则等待时间SIFS后就向源站发送确认帧ACK。AP 覆盖范围内的其他站听到CTS帧后，将在CTS帧中指明的时间内抑制发送。CTS帧有两个目的：
- 给源站明确的发送许可
- 指示其他站在预约期内不要发送。
需要说明的是，源站在 RTS帧中填写的所需占用信道的持续时间，是从 RTS 帧发送完毕后，到目的站最后发送完 ACK 帧为止的时间，即“SIFS+ CTS+SIFS+数据帧 +SIFS+ACK”。
而AP在 CTS帧中填写的所需占用信道的持续时间，是从CTS帧发送完毕，到目的站最后发送完ACK帧为止的时间，即“SIFS+数据帧+SIFS+ACK”。
![11AEE1098ECCCE04F7A55792A966E503 1](https://r2.pipago360.site/pupahub/2024/09/11aee1098eccce04f7a55792a966e503.png)
#### 工作流程
1. 若站点最初有数据要发送（而非发送不成功再进行重传），且检测到信道空闲，那么在等待时间 DIFS后，就发送整个数据帧
2. 否则，站点执行CSMA/CA退避算法，选取一个随机退避值。一旦检测到信道忙，退避计时器就保持不变。只要信道空闲，退避计时器就进行倒计时。
3. 当退避计时器减至0时（这时信道只可能是空闲的），发送整个帧并等待确认
4. 发送站若收到确认就认为已发送的帧已被目的站正确接收。这时要发送第二帧就要从步骤二开始，执行 CSMA/CA 退避算法，随机选定一段退避时间。
若发送站在规定时间（由重传计时器控制）内未收到确认帧 ACK，就必须重传该帧，再以使用 CSMA/CA 协议争用该信道，直到收到确认，或经过若干次重传失败后放弃发送
#### 与csma/cd区别
- CSMA/CD 可以检测冲突，但无法避免；CSMA/CA 发送数据的同时不能检测信道上有无冲突，本结点处没有冲突并**不意味着在接收结点处就没有冲突，只能尽量避免**。
-  传输介质不同。CSMA/CD 用于总线形以太网，CSMA/CA 用于无线局域网802.11/a/b/g/n等
- 检测方式不同。CSMA/CD 通过电缆中的电压变化来检测：而 CSMA/CA 采用能量检测、载波检测和能量载波混合检测三种检测信道空闲的方式。
- 总结：CSMA/CA 在发送数据帧之前先广播告知其他站点，让其他站点在某段时间内不要发送数据帧，以免发生冲突。CSMA/CD 在发送数据帧之前监听，边发送边监听，一旦发生冲突，就立即停止发送
## 轮询
主结点轮流“邀请”从属结点发送数据
## 令牌
- 令牌在网络上循环传递
- 有主机需要发送信息时截获令牌
    - 修改标志位，将令牌占用
    - 将数据附加在令牌后，形成数据帧
    - 再将令牌发送出去
- 令牌继续循环
    - 目标主机将数据部分复制副本
    - 非目标主机直接传走
- 令牌再次回到发送主机
    - 进行校验，若数据出错则再次发送
    - 将数据移除，标志位复位，继续传送令牌